# Email template

```
.mjml ==============> .html ===============> ðŸ“© ======>
       mjml compile          html/template      send
```

## MJML

The `.mjml` is origin, you should edit `.mjml` file instead of `.html` file,
`.html` file is generated by `.mjml` file.

see https://mjml.io for more.

### Variables

The string surrounded by `{{}}` is variable, which will be replace with runtime data.
you should not modify or remove these variables unless you know what are you are doing.

## Html Template

`.html` file is go template file with some placeholder(variables) to replace,
these file will be process by go `html/template` with runtime data,
and generate final email content to send.

see https://pkg.go.dev/html/template for more.

# Inline image

The email module support send inline image with `cid`(Content-ID), this avoids setting up
an image server(whether external service or self-build).

```go
// generate a unique cid identifier
logo_cid := strings.ReplaceAll(uuid.NewString(), "-", "")

// in reality, we should generate it through a template
content := fmt.Sprintf(`
<html>
  <head></head>
  <body>
    <img src="cid:%s" />
  </body>
</html>
`, logo_cid)

m := email.HtmlMessage("subject", content)

// => attach inline image
m.Inline("/path/to/logo.png", logo_cid)

// send the mail
m.Send(...)
```

> There many mail client(web, desktop, mobile), does `cid` work well
> on all of these cients is a question.
> I just test it on few client, Gmail has no problem, Apple Mail(Desktop)
> can show the image but cannot resize it, IPhone Mail has no this problem.
> test on more clients is ongoing work.

*Inline image is not preferred beacuse it increased mail size, we don't
recommend in production deploy, use image url instead.*

## I18n

You can send localized email instead default(in english), this is easy,
just copy the email template to your locale then translate it.

### Locale

The locale is take from browser(or other agent can convey user preferred language),
convert to lowercase language-country format like en-us, zh-hk...

_TODO: Need more explanation_

### I18n example

For example, if you want send email in German, which locale is `de-de`.

1. create a new directory `mjml/de-de`;
2. copy email template file(say `verify-email.mjml`) from `mjml` directory to
   `mjml/de-de`;
3. translate `mjml/de-de/verify-email.mjml` to German.

## Scripts

### Generate .html from .mjml

```
yarn run compile
```

### Watch .mjml change to update .html in real time

```
yarn run watch
```

## Tools

You can edit `.mjml` with [MJML App](https://mjmlio.github.io/mjml-app/),
also some editor has mjml plugin/extension, see
https://documentation.mjml.io/#tooling
